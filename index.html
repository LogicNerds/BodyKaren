<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>BodyTheKaren</title>
<style>
:root{--ink:#1a1f33;--line:#8a64ff66;--panel1:#ffffff;--panel2:#f8f5ff;--accent:#ff4081;--accent2:#ab47bc;--ok:#00c853;--warn:#ff6f00;}
html,body{height:100%;margin:0;background:linear-gradient(180deg,#ffd4e5,#e8c5ff,#c5d9ff);color:var(--ink);font-family:system-ui,Segoe UI,Arial,sans-serif;overflow:hidden;display:flex;align-items:center;justify-content:center;}
.wrap{width:100%;max-width:375px;aspect-ratio:9/16;margin:0 auto;padding:20px 14px 10px 14px;display:flex;flex-direction:column;} 
.hud{display:flex;gap:12px;align-items:center;flex-wrap:wrap;margin-bottom:8px} 
.panel{background:linear-gradient(135deg,rgba(255,255,255,0.95),rgba(240,240,255,0.9));border:2px solid rgba(138,100,255,0.3);border-radius:20px;padding:12px 16px;box-shadow:0 8px 24px rgba(138,100,255,0.15), 0 0 0 1px rgba(255,255,255,0.5) inset;}
.title{font-weight:900;letter-spacing:.3px}
.items{display:flex;gap:8px;flex-wrap:wrap}
.itemBtn{cursor:pointer;border:2px solid rgba(138,100,255,0.3);background:linear-gradient(135deg,rgba(255,255,255,0.9),rgba(250,245,255,0.85));color:var(--ink);border-radius:16px;padding:10px 12px;display:flex;gap:8px;align-items:center;user-select:none;box-shadow:0 4px 12px rgba(138,100,255,0.12);transition:all 0.2s;font-size:14px;font-weight:600;}
.itemBtn:hover{transform:translateY(-2px) scale(1.02);background:linear-gradient(135deg,#fff,rgba(255,250,255,0.95));box-shadow:0 6px 20px rgba(138,100,255,0.25);}
.itemBtn .emoji{font-size:22px;} 
.itemBtn.active{outline:3px solid var(--accent);background:linear-gradient(135deg,rgba(255,100,200,0.15),rgba(138,100,255,0.15));box-shadow:0 0 20px var(--accent), 0 6px 20px rgba(255,64,129,0.4);transform:scale(1.05);} 
.itemBtn.used{opacity:.5;filter:grayscale(0.8);cursor:not-allowed;box-shadow:none;transform:scale(0.95);}
.foot{opacity:.8;font-size:12px;margin-top:6px}
.stageWrap{position:relative;border-radius:24px;border:3px solid rgba(138,100,255,0.4);overflow:hidden;background:linear-gradient(180deg, #a8e6ff 0%, #dbb7ff 50%, #ffc7e8 100%);box-shadow:0 12px 40px rgba(138,100,255,0.3), 0 0 0 1px rgba(255,255,255,0.5) inset;flex:1;display:flex;} 
canvas{display:block;width:100%;flex:1;min-height:0;}
.overlay{position:absolute;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.3);backdrop-filter:blur(2px)}
.overlay .box{background:linear-gradient(135deg,rgba(255,255,255,0.98),rgba(248,245,255,0.98));border:3px solid rgba(138,100,255,0.5);border-radius:24px;padding:24px 28px;max-width:560px;text-align:center;box-shadow:0 20px 60px rgba(138,100,255,0.4), 0 0 0 1px rgba(255,255,255,0.8) inset;}
.overlay h2{margin:0 0 8px}
.overlay .row{display:flex;gap:10px;justify-content:center;margin-top:10px}
.btn{cursor:pointer;border:0;border-radius:16px;padding:12px 20px;font-weight:800;transition:all 0.2s;font-size:15px;}
.btn:hover{transform:translateY(-2px) scale(1.03);}
.btnPrimary{background:linear-gradient(135deg,#ff4081,#ab47bc);color:#fff;box-shadow:0 6px 20px rgba(255,64,129,0.4);}
.btnPrimary:hover{box-shadow:0 8px 28px rgba(255,64,129,0.6);}
.btnGhost{background:rgba(255,255,255,0.9);border:2px solid rgba(138,100,255,0.3);color:var(--ink);box-shadow:0 4px 12px rgba(138,100,255,0.15);}
.btnGhost:hover{background:#fff;box-shadow:0 6px 20px rgba(138,100,255,0.25);}
@media (max-width: 768px) {
  .overlay .box{padding:20px;margin:0 10px;}
  .btn{padding:10px 16px;font-size:14px;}
}
</style>
</head>
<body>
<div class="wrap">
  <div class="hud">
    <div class="panel">
      <div class="title">Body The Karen</div>
      <div class="foot">Pick an item, pull back the slingshot, and yeeeeet <b>before she finds the manager!</b></div>
    </div>
    <div class="panel">
      <div class="items" id="items"></div>
      <div class="foot">Choose your weapon wisely....there's only one of each!</div>
    </div>
  </div>
  <div class="stageWrap">
    <canvas id="stage" width="1100" height="340"></canvas>
    <div class="overlay" id="ovl">
      <div class="box">
        <h2 id="ovlTitle">Mission Complete</h2>
        <div id="ovlMsg">Karen got folded in 18.2s.</div>
        <div class="row">
          <button class="btn btnPrimary" id="again">Play again</button>
        </div>
      </div>
    </div>
  </div>
 <div class="foot" style="margin-top:8px;opacity:.7">No Karens were hurt in the making of this game. Copyright 2025 Neon Bread Studios.</div>
</div>
<audio id="bgMusic" src="fast-battle-intense-8-bit-chiptune-instrumental-378777.mp3" loop></audio>
<script>
const S = (svg) => 'data:image/svg+xml;utf8,' + encodeURIComponent(svg);
const E = (emoji) => `data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 60 60"><text x="30" y="45" font-size="48" text-anchor="middle">${emoji}</text></svg>`;
const SPRITES = {
  toaster: E(`ðŸž`), pan: E(`ðŸ³`), bat: E(`âš¾`), pot: E(`ðŸª´`), laptop: E(`ðŸ’»`), chair: E(`ðŸª‘`), 
  chicken: E(`ðŸ—`), mug: E(`â˜•`), stapler: E(`ðŸ“Ž`), shoe: E(`ðŸ‘Ÿ`), book: E(`ðŸ“š`), 
  sandwich: E(`ðŸ¥ª`), banana: E(`ðŸŒ`), balloon: E(`ðŸŽˆ`), pencil: E(`âœï¸`) 
};
const KAREN = 'https://raw.githubusercontent.com/LogicNerds/BodyKaren/main/assets/karen.png';
const ITEMS = [
  { id:'toaster', name:'Toaster', emoji:'ðŸž', img:SPRITES.toaster, base:0.2 },
  { id:'pan', name:'Pan', emoji:'ðŸ³', img:SPRITES.pan, base:2.2 },
  { id:'bat', name:'Bat', emoji:'âš¾', img:SPRITES.bat, base:1.9 },
  { id:'pot', name:'Plant Pot', emoji:'ðŸª´', img:SPRITES.pot, base:1.3 },
  { id:'laptop', name:'Laptop', emoji:'ðŸ’»', img:SPRITES.laptop, base:1.4 },
  { id:'chair', name:'Chair', emoji:'ðŸª‘', img:SPRITES.chair, base:1.2 },
  { id:'chicken', name:'Rubber Chicken', emoji:'ðŸ—', img:SPRITES.chicken, base:0.1 },
  { id:'mug', name:'Mug', emoji:'â˜•', img:SPRITES.mug, base:1.5 },
  { id:'stapler', name:'Stapler', emoji:'ðŸ“Ž', img:SPRITES.stapler, base:1.0 },
  { id:'shoe', name:'Shoe', emoji:'ðŸ‘Ÿ', img:SPRITES.shoe, base:0.7 },
  { id:'book', name:'Book', emoji:'ðŸ“š', img:SPRITES.book, base:0.9 },
  { id:'sandwich', name:'Sandwich', emoji:'ðŸ¥ª', img:SPRITES.sandwich, base:0.2 },
  { id:'banana', name:'Banana', emoji:'ðŸŒ', img:SPRITES.banana, base:0.25 },
  { id:'balloon', name:'Balloon', emoji:'ðŸŽˆ', img:SPRITES.balloon, base:0.01 },
  { id:'pencil', name:'Pencil', emoji:'âœï¸', img:SPRITES.pencil, base:0.2 },
  { id:'wrench', name:'Wrench', emoji:'ðŸ”§', img:E('ðŸ”§'), base:2.3 },
  { id:'hammer', name:'Hammer', emoji:'ðŸ”¨', img:E('ðŸ”¨'), base:2.5 },
  { id:'pizza', name:'Pizza', emoji:'ðŸ•', img:E('ðŸ•'), base:0.5 },
  { id:'phone', name:'Phone', emoji:'ðŸ“±', img:E('ðŸ“±'), base:1.0 },
  { id:'bottle', name:'Bottle', emoji:'ðŸ¾', img:E('ðŸ¾'), base:0.9 }
];
const MULT = { head:1.5, torso:0.7, arm:0.6, leg:0.5, foot:0.55 };
const WIN_HP = 15;
const ROUND_SECS = 30;
const stage = document.getElementById('stage'), ctx = stage.getContext('2d');
const itemsEl = document.getElementById('items');
const ovl = document.getElementById('ovl'), ovlTitle = document.getElementById('ovlTitle'), ovlMsg = document.getElementById('ovlMsg');
document.getElementById('again').onclick = () => resetGame();
let armed = null, inventory = new Map();
function buildInventory(){
  itemsEl.innerHTML = '';
  inventory.clear();
  ITEMS.forEach(it=>{
    const img = new Image(); img.src = it.img;
    const btn = document.createElement('button');
    btn.className = 'itemBtn'; 
    btn.innerHTML = `<span class="emoji">${it.emoji}</span>`;
    btn.onclick = ()=>{
      if(btn.classList.contains('used')) return;
      armed = it.id;
      document.querySelectorAll('.itemBtn').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
    };
    itemsEl.appendChild(btn);
    inventory.set(it.id, { used:false, img, meta:it, btn });
  });
}
buildInventory();
let W, H; 
const GROUND = () => H-30;
const isMobile = () => true;
function resize(){
  const r = stage.getBoundingClientRect();
  W = stage.width = Math.floor(r.width);
  H = stage.height = Math.floor(r.height);
}
addEventListener('resize', resize); resize();
const GRAV = 1600;
const SLING = { 
  x: () => W * 0.21, 
  y: () => GROUND()-60, 
  maxPull: 230
}; 
const kar = {
  startX: () => W * 0.4,
  endX: () => W * 0.85,
  x: () => {
    if(!startTime || over) return kar.startX();
    const elapsed = (performance.now() - startTime) / 1000;
    const progress = Math.min(1, elapsed / ROUND_SECS);
    return kar.startX() + (kar.endX() - kar.startX()) * progress;
  },
  y: () => GROUND() - 160,
  w: 200, 
  h: 200,
  img: (()=>{ const i=new Image(); i.src=KAREN; return i; })()
};
let projectiles = [], hp = 0, startTime = null, over = false;
function elapsedText(){
  if(!startTime) return '0.0s';
  return Math.max(0, (performance.now()-startTime)/1000).toFixed(1)+'s';
}
let dragging=false, dragStart=null, dragNow=null, dragTimeStart=null; 
function toPos(e){ const r=stage.getBoundingClientRect(); const p=e.touches?e.touches[0]:e; return {x:p.clientX-r.left, y:p.clientY-r.top}; }
function onDown(e){ 
  if(over) return;
  const p=toPos(e); dragging=true; dragStart=p; dragNow=p; 
  dragTimeStart = performance.now(); 
  e.preventDefault(); 
}
function onMove(e){ if(!dragging) return; dragNow=toPos(e); e.preventDefault(); }
function onUp(e){
  if(!dragging) return;
  dragging=false;
  if(!armed) return;
  const pullX = dragStart.x - dragNow.x, pullY = dragStart.y - dragNow.y;
  const pullMag = Math.hypot(pullX, pullY);
  if(pullMag < 10) return;
  const holdDurationSeconds = Math.max(0, (performance.now() - dragTimeStart) / 1000);
  const cappedDuration = Math.min(5, holdDurationSeconds); 
  const MIN_SPEED = 1000, MAX_ADDED_SPEED = 10000; 
  const timePowerFactor = (Math.pow(3, cappedDuration) - 1) / (Math.pow(3, 5) - 1);
  const addedSpeed = MAX_ADDED_SPEED * timePowerFactor; 
  const cappedPullMag = Math.min(SLING.maxPull, pullMag);
  const distanceFactor = cappedPullMag / SLING.maxPull;
  const speed = MIN_SPEED + (addedSpeed * distanceFactor);
  const angle = Math.atan2(pullY, pullX);
  const vx = Math.cos(angle) * speed, vy = Math.sin(angle) * speed; 
  const slot = inventory.get(armed);
  const projSize = isMobile() ? 0.8 : 1;
  projectiles.push({
    id: armed, img: slot.img, base: slot.meta.base,
    x: SLING.x(), y: SLING.y(), vx, vy, 
    r: (16 + Math.min(14, slot.meta.base*5)) * projSize,
    alive: true, hit: false, rot: Math.random()*Math.PI
  });
 slot.used = true; slot.btn.classList.remove('active'); slot.btn.classList.add('used'); armed = null;
  if(!startTime) {
    startTime = performance.now();
    document.getElementById('bgMusic').play().catch(()=>{});
  }
}
stage.addEventListener('mousedown',onDown); stage.addEventListener('mousemove',onMove); addEventListener('mouseup',onUp);
stage.addEventListener('touchstart',onDown,{passive:false}); stage.addEventListener('touchmove',onMove,{passive:false}); stage.addEventListener('touchend',onUp);
function karHitboxes(){
  const x = kar.x(), y = kar.y();
  return {
    head: {x:x+100, y:y+30, w:80, h:70, mult:MULT.head},
    torso:{x:x+95, y:y+100, w:90, h:80, mult:MULT.torso},
    armL: {x:x+75, y:y+100, w:25, h:85, mult:MULT.arm},
    armR: {x:x+180, y:y+100, w:25, h:85, mult:MULT.arm},
    legL: {x:x+105, y:y+145, w:30, h:55, mult:MULT.leg},
    legR: {x:x+145, y:y+145, w:30, h:55, mult:MULT.leg},
    foot:{x:x+105, y:y+185, w:70, h:15, mult:MULT.foot}
  };
}
function circleHitsBox(cx,cy,r,B){
  const nx = Math.max(B.x, Math.min(cx, B.x+B.w));
  const ny = Math.max(B.y, Math.min(cy, B.y+B.h));
  const dx = cx-nx, dy = cy-ny;
  return (dx*dx + dy*dy <= r*r) ? {cx:nx, cy:ny, mult:B.mult} : null;
}
let last = performance.now();
requestAnimationFrame(tick);
function tick(){
  const t = performance.now(), dt = Math.min(0.033, (t-last)/1000); last = t;
  update(dt);
  draw();
  if(!over) requestAnimationFrame(tick);
}
function update(dt){
  if(startTime && !over){
    const rem = Math.max(0, ROUND_SECS - (performance.now()-startTime)/1000);
    if(rem <= 0){ finish(false); return; }
  }
  for(const p of projectiles){
    if(!p.alive) continue;
    p.vy += GRAV * dt;
    p.x  += p.vx * dt;
    p.y  += p.vy * dt;
    p.rot += 2*dt;
    if(p.y + p.r > GROUND()){
      p.y = GROUND() - p.r;
      p.vy *= -0.38;
      p.vx *=  0.72;
      if(Math.abs(p.vy) < 60) p.alive = false;
    }
    if(p.x < -80 || p.x > W+80 || p.y < -120) p.alive=false;
    if(!p.hit){
      const boxes = karHitboxes();
      const hit = circleHitsBox(p.x,p.y,p.r,boxes.head) || circleHitsBox(p.x,p.y,p.r,boxes.torso) ||
                   circleHitsBox(p.x,p.y,p.r,boxes.armL) || circleHitsBox(p.x,p.y,p.r,boxes.armR) ||
                   circleHitsBox(p.x,p.y,p.r,boxes.legL) || circleHitsBox(p.x,p.y,p.r,boxes.legR) ||
                   circleHitsBox(p.x,p.y,p.r,boxes.foot);
      if(hit){
        p.hit = true;
        const variance = 0.9 + Math.random()*0.2;
        const gain = +(p.base * hit.mult * variance).toFixed(2);
        addHP(gain, p.x, p.y); 
        p.vx *= 0.6; p.vy *= 0.6;
      }
    }
  }
  projectiles = projectiles.filter(p=>p.alive);
}
function addHP(g, x, y){
  hp = Math.min(WIN_HP, +(hp + g).toFixed(2));
  const fl = document.createElement('div');
  fl.textContent = '+'+g.toFixed(2);
  const r = stage.getBoundingClientRect();
  fl.style.cssText = `position:fixed;left:${r.left+x}px;top:${r.top+y}px;transform:translate(-50%,-50%);font-weight:900;color:${g>=2?'#00c853':(g>=1?'#ff6f00':'#ff4081')};text-shadow:0 2px 4px rgba(0,0,0,0.3);pointer-events:none;z-index:100;transition:all .7s ease-out;opacity:1;font-size:18px`;
  document.body.appendChild(fl);
  requestAnimationFrame(()=>{ fl.style.opacity='0'; fl.style.top=(r.top+y-80)+'px'; });
  setTimeout(()=>fl.remove(), 800);
  if(hp >= WIN_HP) finish(true);
}
function finish(win){
  over = true;
  ovl.style.display='flex';
  if(win) {
    ovlTitle.textContent = 'Karen Neutralized!';
    ovlMsg.innerHTML = `Karen <b>folded</b> in <b>${elapsedText()}</b>.`;
  } else {
     if (hp >= WIN_HP) {
        ovlTitle.textContent = 'Mission Complete';
        ovlMsg.innerHTML = `Karen <b>took the L</b> just as time expired! (${elapsedText()})`;
     } else {
        ovlTitle.textContent = 'Karen Found the Manager! ðŸ˜ ';
        ovlMsg.innerHTML = `Time ran out. You only reached <b>${hp.toFixed(1)}/${WIN_HP} HP</b>. Why you no try harder!?`;
     }
  }
}
function resetGame(){
  hp = 0; startTime = null; over = false;
  projectiles = [];
  buildInventory();
  ovl.style.display='none';
  last = performance.now();
  requestAnimationFrame(tick);
}
function draw(){
  ctx.clearRect(0,0,W,H);
  ctx.fillStyle = '#a8d5ba'; 
  ctx.fillRect(0,GROUND(),W,H-GROUND());
  ctx.fillStyle = '#8bc9a3'; 
  for(let i=0;i<W;i+=28) ctx.fillRect(i,GROUND(),14,5);
  ctx.fillStyle = 'rgba(0,0,0,0.15)';
  ctx.fillRect(10, 10, 100, 36);
  ctx.fillStyle = 'rgba(255,255,255,0.95)';
  ctx.fillRect(12, 12, 96, 32);
  ctx.fillStyle = '#1a1f33';
  ctx.font = 'bold 18px system-ui';
  ctx.fillText(`${hp.toFixed(1)}/${WIN_HP}`, 20, 34);
  const slingX = SLING.x(), slingY = SLING.y();
  const scale = isMobile() ? 0.8 : 1;
  ctx.fillStyle='#8b5a3c';
  ctx.strokeStyle='#5d3a1a';
  ctx.lineWidth=2;
  ctx.fillRect(slingX+12*scale, GROUND()-65*scale, 8*scale, 70*scale);
  ctx.strokeRect(slingX+12*scale, GROUND()-65*scale, 8*scale, 70*scale);
  ctx.beginPath();
  ctx.moveTo(slingX+16*scale, GROUND()-65*scale);
  ctx.lineTo(slingX+4*scale, GROUND()-90*scale);
  ctx.lineTo(slingX+10*scale, GROUND()-92*scale);
  ctx.lineTo(slingX+18*scale, GROUND()-68*scale);
  ctx.closePath();
  ctx.fill();
  ctx.stroke();
  ctx.beginPath();
  ctx.moveTo(slingX+16*scale, GROUND()-65*scale);
  ctx.lineTo(slingX+28*scale, GROUND()-90*scale);
  ctx.lineTo(slingX+22*scale, GROUND()-92*scale);
  ctx.lineTo(slingX+14*scale, GROUND()-68*scale);
  ctx.closePath();
  ctx.fill();
  ctx.stroke();
  ctx.fillStyle='#5d3a1a';
  ctx.beginPath();
  ctx.arc(slingX+7*scale, GROUND()-91*scale, 4*scale, 0, Math.PI*2);
  ctx.fill();
  ctx.beginPath();
  ctx.arc(slingX+25*scale, GROUND()-91*scale, 4*scale, 0, Math.PI*2);
  ctx.fill();
  if(dragging){
    ctx.strokeStyle = '#ff4081'; 
    ctx.lineWidth = 5;
    ctx.beginPath();
    ctx.moveTo(slingX+7*scale, GROUND()-91*scale);
    ctx.lineTo(dragNow.x, dragNow.y);
    ctx.lineTo(slingX+25*scale, GROUND()-91*scale);
    ctx.stroke();
    ctx.fillStyle='#8d6e63';
    ctx.fillRect(dragNow.x-8, dragNow.y-6, 16, 12);
    ctx.strokeStyle='#5d4037';
    ctx.lineWidth=2;
    ctx.strokeRect(dragNow.x-8, dragNow.y-6, 16, 12);
  } else {
    ctx.strokeStyle = '#ff4081'; 
    ctx.lineWidth = 5;
    ctx.beginPath();
    ctx.moveTo(slingX+7*scale, GROUND()-91*scale);
    ctx.lineTo(slingX+16*scale, GROUND()-88*scale);
    ctx.lineTo(slingX+25*scale, GROUND()-91*scale);
    ctx.stroke();
    ctx.fillStyle='#8d6e63';
    ctx.fillRect(slingX+8*scale, GROUND()-93*scale, 16*scale, 10*scale);
    ctx.strokeStyle='#5d4037';
    ctx.lineWidth=2;
    ctx.strokeRect(slingX+8*scale, GROUND()-93*scale, 16*scale, 10*scale);
  }
  const karenX = kar.x();
  ctx.drawImage(kar.img, karenX, kar.y(), kar.w, kar.h);
  const hudX = karenX+20, hudY = kar.y()-18;
  ctx.fillStyle = 'rgba(0,0,0,.2)'; 
  ctx.fillRect(hudX-2, hudY-10, 120+4, 10+4);
  const pct = hp/WIN_HP;
  ctx.fillStyle = pct>=1 ? '#00c853' : (pct>0.6 ? '#ff6f00' : '#ff4081');
  ctx.fillRect(hudX, hudY-8, Math.max(0,120*pct), 8);
  ctx.strokeStyle = 'rgba(138,100,255,0.6)'; 
  ctx.strokeRect(hudX, hudY-8, 120, 8);
  let tLeft = startTime ? Math.max(0, ROUND_SECS - (performance.now()-startTime)/1000) : ROUND_SECS;
  ctx.fillStyle = '#1a1f33'; 
  ctx.font = 'bold 12px system-ui, sans-serif';
  ctx.fillText((tLeft).toFixed(1)+'s', hudX+126, hudY);
  for(const p of projectiles){
    ctx.save();
    ctx.translate(p.x, p.y);
    ctx.rotate(p.rot);
    const size = p.r*2;
    ctx.drawImage(p.img, -size/2, -size/2, size, size);
    ctx.restore();
  }
}
</script>
</body>
</html>
